/* Generated by CIL v. 1.3.6 */
/* print_CIL_Input is false */

typedef unsigned long long __u_quad_t;
typedef __u_quad_t __dev_t;
typedef unsigned int __uid_t;
typedef unsigned int __gid_t;
typedef unsigned long __ino_t;
typedef unsigned int __mode_t;
typedef unsigned int __nlink_t;
typedef long __off_t;
typedef long __time_t;
typedef long __blksize_t;
typedef long __blkcnt_t;
typedef int __ssize_t;
struct timespec {
   __time_t tv_sec ;
   long tv_nsec ;
};
typedef __uid_t uid_t;
struct stat {
   __dev_t st_dev ;
   unsigned short __pad1 ;
   __ino_t st_ino ;
   __mode_t st_mode ;
   __nlink_t st_nlink ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   __dev_t st_rdev ;
   unsigned short __pad2 ;
   __off_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   unsigned long __unused4 ;
   unsigned long __unused5 ;
};
typedef unsigned int size_t;
typedef __ssize_t ssize_t;
struct __anonstruct___sigset_t_4 {
   unsigned long __val[1024U / (8U * sizeof(unsigned long ))] ;
};
typedef struct __anonstruct___sigset_t_4 __sigset_t;
typedef __sigset_t sigset_t;
extern  __attribute__((__nothrow__)) int lstat(char const   * __restrict  __file ,
                                               struct stat * __restrict  __buf )  __attribute__((__nonnull__(1,2))) ;
extern  __attribute__((__nothrow__)) int *__errno_location(void)  __attribute__((__const__)) ;
extern  __attribute__((__nothrow__)) void *calloc(size_t __nmemb ,
                                                  size_t __size )  __attribute__((__malloc__)) ;
extern  __attribute__((__nothrow__)) void free(void *__ptr ) ;
extern  __attribute__((__nothrow__)) char *strcpy(char * __restrict  __dest ,
                                                  char const   * __restrict  __src )  __attribute__((__nonnull__(1,2))) ;
extern  __attribute__((__nothrow__)) char *strncpy(char * __restrict  __dest ,
                                                   char const   * __restrict  __src ,
                                                   size_t __n )  __attribute__((__nonnull__(1,2))) ;
extern  __attribute__((__nothrow__)) char *strcat(char * __restrict  __dest ,
                                                  char const   * __restrict  __src )  __attribute__((__nonnull__(1,2))) ;
extern  __attribute__((__nothrow__)) char *strrchr(char const   *__s ,
                                                   int __c )  __attribute__((__pure__,
__nonnull__(1))) ;
extern  __attribute__((__nothrow__)) size_t strlen(char const   *__s )  __attribute__((__pure__,
__nonnull__(1))) ;
extern int close(int __fd ) ;
extern  __attribute__((__nothrow__)) int chdir(char const   *__path )  __attribute__((__nonnull__(1))) ;
extern  __attribute__((__nothrow__)) int fchdir(int __fd ) ;
extern  __attribute__((__nothrow__)) char *getcwd(char *__buf , size_t __size ) ;
extern  __attribute__((__nothrow__)) __uid_t geteuid(void) ;
extern  __attribute__((__nothrow__)) int seteuid(__uid_t __uid ) ;
extern  __attribute__((__nothrow__)) ssize_t readlink(char const   * __restrict  __path ,
                                                      char * __restrict  __buf ,
                                                      size_t __len )  __attribute__((__nonnull__(1,2))) ;
extern int open(char const   *__file , int __oflag  , ...)  __attribute__((__nonnull__(1))) ;
extern  __attribute__((__nothrow__)) int sigemptyset(sigset_t *__set )  __attribute__((__nonnull__(1))) ;
extern  __attribute__((__nothrow__)) int sigaddset(sigset_t *__set ,
                                                   int __signo )  __attribute__((__nonnull__(1))) ;
extern  __attribute__((__nothrow__)) int sigprocmask(int __how ,
                                                     sigset_t const   * __restrict  __set ,
                                                     sigset_t * __restrict  __oset ) ;
extern int printf(char const   * __restrict  __format  , ...) ;
char *fb_realpath(char const   *path , char *resolved ) ;
static sigset_t saved_sigmask ;
static sigset_t block_sigmask ;
static int delaying ;
static int init_done ;
static void init_mask(void) 
{ int sig ;
  
  {/*sid:1*/
  init_done = 1;
  /*sid:1*/
  /*T(saved_sigmask) = G(saved_sigmask)*/
  /*T(block_sigmask) = G(block_sigmask)*/
  /*T(delaying) = G(delaying)*/
  /*T(init_done) = U*/
  /*T(sig) = U*/
  /*T(init_mask) = G(delaying) + G(saved_sigmask) + G(block_sigmask) + G(init_done)*/
  
  /*sid:2*/
  sigemptyset(& block_sigmask);
  /*sid:3*/
  sig = 1;
  /*sid:4*/
  while (sig < 65) {/*sid:8*/
    sigaddset(& block_sigmask, sig);
    /*sid:9*/
    sig ++;}
  
  /*sid:399*/
  return;
  /*sid:399*/
  /*T(init_mask) = U*/
  }

}
int enable_signaling(void) 
{ int tmp ;
  int __retres ;
  
  {/*sid:12*/
  if (delaying != 0) {/*sid:13*/
    delaying = 0;
    /*sid:14*/
    tmp = sigprocmask(2, (sigset_t const   *)(& saved_sigmask),
                      (sigset_t *)((sigset_t *)0));
    /*sid:14*/
    /*T(tmp) = G(delaying)*/
    
    /*sid:15*/
    if (tmp < 0) {/*sid:16*/
      __retres = -1;
      /*sid:16*/
      /*T(__retres) = G(delaying)*/
      
      /*sid:400*/
      goto return_label;}
    }
  
  /*sid:12*/
  /*T(saved_sigmask) = G(saved_sigmask)*/
  /*T(block_sigmask) = G(block_sigmask)*/
  /*T(delaying) = G(delaying)*/
  /*T(init_done) = G(init_done)*/
  /*T(__retres) = U*/
  /*T(enable_signaling) = G(delaying) + G(saved_sigmask) + G(block_sigmask) + G(init_done)*/
  /*T(tmp) = U*/
  
  /*sid:19*/
  __retres = 0;
  /*sid:19*/
  /*T(__retres) = G(delaying)*/
  /*T(tmp) = G(delaying)*/
  
  /*sid:401*/
  return_label: /* CIL Label */ 
  return (__retres);
  /*sid:401*/
  /*T(enable_signaling) = G(delaying)*/
  }

}
int delay_signaling(void) 
{ int tmp ;
  int __retres ;
  
  {/*sid:21*/
  if (init_done == 0) {/*sid:22*/
    init_mask();}
  
  /*sid:21*/
  /*T(saved_sigmask) = G(saved_sigmask)*/
  /*T(block_sigmask) = G(block_sigmask)*/
  /*T(delaying) = G(delaying)*/
  /*T(init_done) = G(init_done)*/
  /*T(__retres) = U*/
  /*T(delay_signaling) = G(delaying) + G(saved_sigmask) + G(block_sigmask) + G(init_done)*/
  /*T(tmp) = U*/
  
  /*sid:25*/
  if (delaying == 0) {/*sid:26*/
    delaying = 1;
    /*sid:27*/
    tmp = sigprocmask(0, (sigset_t const   *)(& block_sigmask),
                      (sigset_t *)(& saved_sigmask));
    /*sid:27*/
    /*T(tmp) = G(delaying)*/
    
    /*sid:28*/
    if (tmp < 0) {/*sid:29*/
      __retres = -1;
      /*sid:29*/
      /*T(__retres) = G(delaying)*/
      
      /*sid:402*/
      goto return_label;}
    }
  
  /*sid:32*/
  __retres = 0;
  /*sid:32*/
  /*T(__retres) = G(delaying)*/
  /*T(tmp) = G(delaying)*/
  
  /*sid:403*/
  return_label: /* CIL Label */ 
  return (__retres);
  /*sid:403*/
  /*T(delay_signaling) = G(delaying)*/
  }

}
char *wu_realpath(char const   *path , char * /*[46]*/  resolved_path ,
                  char *chroot_path ) 
{ char *ptr ;
  char q[46] ;
  size_t tmp ;
  size_t tmp_0 ;
  size_t tmp_1 ;
  size_t tmp_2 ;
  size_t tmp_3 ;
  size_t tmp_4 ;
  size_t tmp_5 ;
  char *__retres ;
  
  {/*sid:33*/
  fb_realpath(path, q);
  /*sid:33*/
  /*T(saved_sigmask) = T*/
  /*T(block_sigmask) = T*/
  /*T(delaying) = T*/
  /*T(init_done) = T*/
  /*T(__retres) = U*/
  /*T(wu_realpath) = G(delaying) + G(saved_sigmask) + G(resolved_path) + G(path) + G(chroot_path) + G(block_sigmask) + G(init_done)*/
  /*T(path) = G(path)*/
  /*T(resolved_path) = G(resolved_path)*/
  /*T(chroot_path) = G(chroot_path)*/
  /*T(ptr) = U*/
  /*T(q) = T*/
  /*T(tmp) = U*/
  /*T(tmp_0) = U*/
  /*T(tmp_1) = U*/
  /*T(tmp_2) = U*/
  /*T(tmp_3) = U*/
  /*T(tmp_4) = U*/
  /*T(tmp_5) = U*/
  
  /*sid:34*/
  tmp = strlen((char const   *)(q));
  /*sid:34*/
  /*T(tmp) = T*/
  
  /*sid:35*/
  printf((char const   *)"strlen(q) = %d\n", tmp);
  /*sid:36*/
  printf((char const   *)"q[MAXPATHLEN - 1] = %c\n", q[46 - 1]);
  /*sid:38*/
  if (chroot_path == (void *)0)
  {/*sid:39*/
  strcpy((char *)resolved_path, (char const   *)(q));
  /*sid:39*/
  /*T(resolved_path) = T*/
  }
  else {/*sid:40*/
  strcpy((char *)resolved_path, (char const   *)chroot_path);
  /*sid:40*/
  /*T(resolved_path) = G(chroot_path)*/
  
  /*sid:42*/
  if ((int )q[0] != '/')
  {/*sid:43*/
  {/*sid:44*/
   tmp_0 = strlen((char const   *)resolved_path);
   /*sid:44*/
   /*T(tmp_0) = T*/
   
   /*sid:45*/
   tmp_1 = strlen((char const   *)(q));
   /*sid:45*/
   /*T(tmp_1) = T*/
   }
  /*sid:46*/
  if (tmp_0 + tmp_1 < (size_t )46)
  {/*sid:47*/
  strcat((char *)resolved_path, (char const   *)(q));
  /*sid:47*/
  /*T(resolved_path) = T*/
  }
  else {/*sid:48*/
  __retres = (char *)((void *)0);
  /*sid:48*/
  /*T(__retres) = T*/
  
  /*sid:404*/
  goto return_label;}
  }
  else {/*sid:50*/
  if ((int )q[1] != '\000') {/*sid:51*/
    ptr = q;
    /*sid:51*/
    /*T(ptr) = T*/
    
    /*sid:52*/
    while ((int )*ptr != '\000') {/*sid:57*/
      ptr ++;}
    
    /*sid:59*/
    if (ptr == resolved_path) {/*sid:60*/
    goto _L;}
    else {/*sid:61*/
    {/*sid:62*/
     ptr --;
     /*sid:63*/
     }
    /*sid:64*/
    if ((int )*ptr != '/')
    {/*sid:65*/
    {/*sid:66*/
     _L: /* CIL Label */ 
     tmp_2 = strlen((char const   *)resolved_path);
     /*sid:66*/
     /*T(tmp_2) = T*/
     
     /*sid:67*/
     tmp_3 = strlen((char const   *)(q));
     /*sid:67*/
     /*T(tmp_3) = T*/
     }
    /*sid:68*/
    if (tmp_2 + tmp_3 < (size_t )46)
    {/*sid:69*/
    strcat((char *)resolved_path, (char const   *)(q));
    /*sid:69*/
    /*T(resolved_path) = T*/
    /*T(tmp_0) = T*/
    /*T(tmp_1) = T*/
    }
    else {/*sid:70*/
    __retres = (char *)((void *)0);
    /*sid:70*/
    /*T(__retres) = T*/
    
    /*sid:405*/
    goto return_label;}
    }
    else {/*sid:71*/
    {/*sid:72*/
     tmp_4 = strlen((char const   *)resolved_path);
     /*sid:72*/
     /*T(tmp_4) = T*/
     
     /*sid:73*/
     tmp_5 = strlen((char const   *)(q));
     /*sid:73*/
     /*T(tmp_5) = T*/
     }
    /*sid:74*/
    if ((tmp_4 + tmp_5) - (size_t )1 < (size_t )46)
    {/*sid:75*/
    strcat((char *)resolved_path, (char const   *)(& q[1]));
    /*sid:75*/
    /*T(resolved_path) = T*/
    /*T(tmp_0) = T*/
    /*T(tmp_1) = T*/
    /*T(tmp_2) = T*/
    /*T(tmp_3) = T*/
    }
    else {/*sid:76*/
    __retres = (char *)((void *)0);
    /*sid:76*/
    /*T(__retres) = T*/
    
    /*sid:406*/
    goto return_label;}
    }
    }
    }
  }
  }
  
  /*sid:78*/
  __retres = (char *)resolved_path;
  /*sid:78*/
  /*T(__retres) = T*/
  /*T(resolved_path) = T*/
  /*T(ptr) = T*/
  /*T(tmp_0) = T*/
  /*T(tmp_1) = T*/
  /*T(tmp_2) = T*/
  /*T(tmp_3) = T*/
  /*T(tmp_4) = T*/
  /*T(tmp_5) = T*/
  
  /*sid:407*/
  return_label: /* CIL Label */ 
  return (__retres);
  /*sid:407*/
  /*T(wu_realpath) = T*/
  /*T(resolved_path) = T*/
  /*T(ptr) = T*/
  /*T(tmp_0) = T*/
  /*T(tmp_1) = T*/
  /*T(tmp_2) = T*/
  /*T(tmp_3) = T*/
  /*T(tmp_4) = T*/
  /*T(tmp_5) = T*/
  }

}
char *fb_realpath(char const   *path , char *resolved ) 
{ struct stat sb ;
  int fd ;
  int rootd ;
  int serrno ;
  char *p ;
  char *q ;
  char wbuf[46] ;
  int resultcode ;
  int *tmp ;
  uid_t userid ;
  int *tmp_1 ;
  int *tmp_2 ;
  uid_t userid_0 ;
  int *tmp_4 ;
  int *tmp_5 ;
  int *tmp_6 ;
  int *tmp_7 ;
  uid_t userid_1 ;
  int *tmp_9 ;
  int *tmp_10 ;
  int symlinks ;
  int n ;
  int *tmp_11 ;
  int *tmp_12 ;
  size_t len ;
  char *tmp_14 ;
  int *tmp_16 ;
  uid_t userid_2 ;
  int *tmp_18 ;
  int *tmp_19 ;
  int *tmp_20 ;
  uid_t userid_3 ;
  int *tmp_22 ;
  int *tmp_23 ;
  int *tmp_24 ;
  char *tmp_26 ;
  uid_t userid_4 ;
  int *tmp_28 ;
  char *tmp_30 ;
  int *tmp_31 ;
  size_t tmp_32 ;
  size_t tmp_33 ;
  size_t tmp_34 ;
  size_t tmp_35 ;
  int *tmp_36 ;
  size_t tmp_37 ;
  size_t tmp_38 ;
  size_t tmp_39 ;
  size_t tmp_40 ;
  size_t tmp_41 ;
  size_t tmp_42 ;
  int *tmp_43 ;
  uid_t userid_5 ;
  int *tmp_45 ;
  int *tmp_46 ;
  int *tmp_47 ;
  int *tmp_48 ;
  uid_t userid_6 ;
  int *tmp_50 ;
  int *tmp_51 ;
  char *__retres ;
  
  {/*sid:79*/
  {/*sid:80*/
   tmp = __errno_location();
   /*sid:81*/
   *tmp = 0;}
  /*sid:79*/
  /*T(tmp_26) = U*/
  /*T(userid_4) = U*/
  /*T(tmp_28) = U*/
  /*T(tmp_30) = U*/
  /*T(tmp_31) = U*/
  /*T(tmp_32) = U*/
  /*T(tmp_33) = U*/
  /*T(tmp_34) = U*/
  /*T(tmp_35) = U*/
  /*T(tmp_36) = U*/
  /*T(tmp_37) = U*/
  /*T(tmp_38) = U*/
  /*T(tmp_39) = U*/
  /*T(tmp_40) = U*/
  /*T(tmp_41) = U*/
  /*T(tmp_42) = U*/
  /*T(tmp_43) = U*/
  /*T(userid_5) = U*/
  /*T(tmp_45) = U*/
  /*T(tmp_46) = U*/
  /*T(tmp_47) = U*/
  /*T(tmp_48) = U*/
  /*T(userid_6) = U*/
  /*T(tmp_50) = U*/
  /*T(tmp_51) = U*/
  /*T(saved_sigmask) = G(saved_sigmask)*/
  /*T(block_sigmask) = G(block_sigmask)*/
  /*T(delaying) = G(delaying)*/
  /*T(init_done) = G(init_done)*/
  /*T(__retres) = U*/
  /*T(fb_realpath) = G(delaying) + G(saved_sigmask) + G(path) + G(resolved) + G(block_sigmask) + G(init_done)*/
  /*T(path) = G(path)*/
  /*T(resolved) = G(resolved)*/
  /*T(sb) = U*/
  /*T(fd) = U*/
  /*T(rootd) = U*/
  /*T(serrno) = U*/
  /*T(p) = U*/
  /*T(q) = U*/
  /*T(wbuf) = U*/
  /*T(resultcode) = U*/
  /*T(tmp) = U*/
  /*T(userid) = U*/
  /*T(tmp_1) = U*/
  /*T(tmp_2) = U*/
  /*T(userid_0) = U*/
  /*T(tmp_4) = U*/
  /*T(tmp_5) = U*/
  /*T(tmp_6) = U*/
  /*T(tmp_7) = U*/
  /*T(userid_1) = U*/
  /*T(tmp_9) = U*/
  /*T(tmp_10) = U*/
  /*T(symlinks) = U*/
  /*T(n) = U*/
  /*T(tmp_11) = U*/
  /*T(tmp_12) = U*/
  /*T(len) = U*/
  /*T(tmp_14) = U*/
  /*T(tmp_16) = U*/
  /*T(userid_2) = U*/
  /*T(tmp_18) = U*/
  /*T(tmp_19) = U*/
  /*T(tmp_20) = U*/
  /*T(userid_3) = U*/
  /*T(tmp_22) = U*/
  /*T(tmp_23) = U*/
  /*T(tmp_24) = U*/
  
  /*sid:82*/
  fd = open(".", 0);
  /*sid:83*/
  {/*sid:84*/
   tmp_1 = __errno_location();
   /*sid:85*/
   }
  /*sid:86*/
  if (13 == *tmp_1) {/*sid:87*/
    userid = geteuid();
    /*sid:88*/
    delay_signaling();
    /*sid:89*/
    seteuid(0U);
    /*sid:90*/
    fd = open(".", 0);
    /*sid:91*/
    seteuid(userid);
    /*sid:92*/
    enable_signaling();}
  
  /*sid:95*/
  if (fd < 0) {/*sid:96*/
    strcpy((char *)resolved, (char const   *)".");
    /*sid:96*/
    /*T(resolved) = U*/
    
    /*sid:97*/
    __retres = (char *)((void *)0);
    /*sid:408*/
    goto return_label;}
  
  /*sid:99*/
  strncpy((char *)resolved, (char const   *)path, (unsigned int )(46 - 1));
  /*sid:100*/
  *(resolved + (46 - 1)) = (char )'\000';
  /*sid:101*/
  loop: 
  q = strrchr((char const   *)resolved, '/');
  /*sid:101*/
  /*T(resolved) = T*/
  /*T(p) = T*/
  /*T(q) = T*/
  /*T(resultcode) = T*/
  /*T(tmp_2) = T*/
  /*T(userid_0) = T*/
  /*T(tmp_4) = T*/
  /*T(tmp_5) = T*/
  /*T(tmp_6) = T*/
  /*T(tmp_7) = T*/
  /*T(userid_1) = T*/
  /*T(tmp_9) = T*/
  /*T(tmp_10) = T*/
  /*T(symlinks) = T*/
  /*T(n) = T*/
  /*T(tmp_12) = T*/
  /*T(len) = T*/
  /*T(tmp_14) = T*/
  /*T(userid_2) = T*/
  /*T(tmp_18) = T*/
  /*T(tmp_19) = T*/
  
  /*sid:102*/
  printf((char const   *)"q inside LOOP = %s\n", q);
  /*sid:102*/
  /*T(saved_sigmask) = T*/
  /*T(block_sigmask) = T*/
  /*T(delaying) = T*/
  /*T(init_done) = T*/
  
  /*sid:104*/
  if (q != (void *)0)
  {/*sid:105*/
  p = q + 1;
  /*sid:107*/
  if (q == resolved) {/*sid:108*/
  q = (char *)"/";}
  else {/*sid:109*/
  while (1) {/*sid:110*/
    q --;
    /*sid:112*/
    if (q > resolved)
    {/*sid:114*/
    if (! ((int )*q == '/')) {/*sid:115*/
      break;
      /*sid:115*/
      /*T(userid_0) = G(resolved)*/
      /*T(tmp_4) = G(resolved)*/
      }
    }
    else {/*sid:116*/
    break;}
    }
  
  /*sid:117*/
  *(q + 1) = (char )'\000';
  /*sid:117*/
  /*T(userid_0) = T*/
  /*T(tmp_4) = T*/
  
  /*sid:118*/
  q = resolved;}
  
  /*sid:119*/
  {/*sid:120*/
   tmp_2 = __errno_location();
   /*sid:121*/
   *tmp_2 = 0;}
  /*sid:122*/
  printf((char const   *)"trying to chdir(%s)\n", q);
  /*sid:123*/
  resultcode = chdir((char const   *)q);
  /*sid:124*/
  {/*sid:125*/
   tmp_5 = __errno_location();
   /*sid:126*/
   }
  /*sid:127*/
  if (13 == *tmp_5) {/*sid:128*/
    userid_0 = geteuid();
    /*sid:129*/
    delay_signaling();
    /*sid:130*/
    seteuid(0U);
    /*sid:131*/
    {/*sid:132*/
     tmp_4 = __errno_location();
     /*sid:133*/
     *tmp_4 = 0;}
    /*sid:134*/
    resultcode = chdir((char const   *)q);
    /*sid:135*/
    seteuid(userid_0);
    /*sid:136*/
    enable_signaling();}
  
  /*sid:139*/
  if (resultcode < 0) {/*sid:140*/
    printf((char const   *)"error occurred while trying to chdir(%s)\n", q);
    /*sid:141*/
    goto err1;}
  }
  else {/*sid:143*/
  p = resolved;}
  
  /*sid:145*/
  if ((int )*p != '\000') {/*sid:146*/
    {/*sid:147*/
     tmp_6 = __errno_location();
     /*sid:148*/
     *tmp_6 = 0;}
    /*sid:149*/
    printf((char const   *)"trying to lstat %s\n", p);
    /*sid:150*/
    resultcode = lstat((char const   *)p, (struct stat *)(& sb));
    /*sid:151*/
    printf((char const   *)"Resultcode = %d\n", resultcode);
    /*sid:152*/
    tmp_7 = __errno_location();
    /*sid:153*/
    printf((char const   *)"errno=%d\n", *tmp_7);
    /*sid:154*/
    {/*sid:155*/
     tmp_10 = __errno_location();
     /*sid:156*/
     }
    /*sid:157*/
    if (13 == *tmp_10) {/*sid:158*/
      userid_1 = geteuid();
      /*sid:159*/
      delay_signaling();
      /*sid:160*/
      seteuid(0U);
      /*sid:161*/
      {/*sid:162*/
       tmp_9 = __errno_location();
       /*sid:163*/
       *tmp_9 = 0;}
      /*sid:164*/
      resultcode = lstat((char const   *)p, (struct stat *)(& sb));
      /*sid:165*/
      seteuid(userid_1);
      /*sid:166*/
      enable_signaling();}
    
    /*sid:169*/
    if (resultcode == 0) {/*sid:170*/
      symlinks = 0;
      /*sid:171*/
      printf((char const   *)"sb.st_mode=%d\n", sb.st_mode);
      /*sid:171*/
      /*T(saved_sigmask) = U*/
      /*T(block_sigmask) = U*/
      /*T(delaying) = U*/
      /*T(init_done) = U*/
      
      /*sid:173*/
      if ((sb.st_mode & 61440U) == 32768U) {/*sid:174*/
        printf((char const   *)"isreg\n");}
      
      /*sid:177*/
      if ((sb.st_mode & 61440U) == 16384U) {/*sid:178*/
        printf((char const   *)"isdir\n");}
      
      /*sid:181*/
      if ((sb.st_mode & 61440U) == 8192U) {/*sid:182*/
        printf((char const   *)"ischr\n");}
      
      /*sid:185*/
      if ((sb.st_mode & 61440U) == 24576U) {/*sid:186*/
        printf((char const   *)"isblk\n");}
      
      /*sid:189*/
      if ((sb.st_mode & 61440U) == 4096U) {/*sid:190*/
        printf((char const   *)"isfifo\n");}
      
      /*sid:193*/
      if ((sb.st_mode & 61440U) == 40960U) {/*sid:194*/
        printf((char const   *)"islnk\n");}
      
      /*sid:197*/
      if ((sb.st_mode & 61440U) == 49152U) {/*sid:198*/
        printf((char const   *)"issock\n");}
      
      /*sid:201*/
      if ((sb.st_mode & 61440U) == 40960U) {/*sid:202*/
        symlinks ++;
        /*sid:203*/
        if (symlinks > 5) {/*sid:204*/
          {/*sid:205*/
           tmp_11 = __errno_location();
           /*sid:205*/
           /*T(tmp_11) = T*/
           
           /*sid:206*/
           *tmp_11 = 40;}
          /*sid:207*/
          goto err1;}
        
        /*sid:209*/
        {/*sid:210*/
         tmp_12 = __errno_location();
         /*sid:211*/
         *tmp_12 = 0;}
        /*sid:212*/
        len = strlen((char const   *)p);
        /*sid:213*/
        tmp_14 = (char *)calloc(len + (size_t )1, sizeof(char ));
        /*sid:215*/
        if (tmp_14 == (char *)0) {/*sid:216*/
          tmp_16 = __errno_location();
          /*sid:216*/
          /*T(tmp_16) = T*/
          
          /*sid:217*/
          serrno = *tmp_16;
          /*sid:217*/
          /*T(serrno) = T*/
          
          /*sid:218*/
          goto err1;}
        
        /*sid:220*/
        strcpy((char *)tmp_14, (char const   *)p);
        /*sid:221*/
        p = tmp_14;
        /*sid:222*/
        n = readlink((char const   *)p, (char *)resolved, 46U);
        /*sid:223*/
        {/*sid:224*/
         tmp_19 = __errno_location();
         /*sid:225*/
         }
        /*sid:226*/
        if (13 == *tmp_19) {/*sid:227*/
          userid_2 = geteuid();
          /*sid:228*/
          delay_signaling();
          /*sid:229*/
          seteuid(0U);
          /*sid:230*/
          {/*sid:231*/
           tmp_18 = __errno_location();
           /*sid:232*/
           *tmp_18 = 0;}
          /*sid:233*/
          n = readlink((char const   *)p, (char *)resolved, 46U);
          /*sid:234*/
          seteuid(userid_2);
          /*sid:235*/
          enable_signaling();}
        
        /*sid:238*/
        if (n < 0) {/*sid:239*/
          free((void *)p);
          /*sid:240*/
          goto err1;}
        
        /*sid:242*/
        free((void *)p);
        /*sid:243*/
        *(resolved + n) = (char )'\000';
        /*sid:244*/
        goto loop;
        /*sid:244*/
        /*T(saved_sigmask) = G(saved_sigmask)*/
        /*T(block_sigmask) = G(block_sigmask)*/
        /*T(delaying) = G(delaying)*/
        /*T(init_done) = G(init_done)*/
        }
      
      /*sid:247*/
      if ((sb.st_mode & 61440U) == 16384U) {/*sid:248*/
        printf((char const   *)"S_ISDIR..\n");
        /*sid:249*/
        {/*sid:250*/
         tmp_20 = __errno_location();
         /*sid:250*/
         /*T(tmp_20) = T*/
         
         /*sid:251*/
         *tmp_20 = 0;}
        /*sid:252*/
        resultcode = chdir((char const   *)p);
        /*sid:253*/
        printf((char const   *)"chdir(%s) = resultcode = %d\n", p, resultcode);
        /*sid:253*/
        /*T(saved_sigmask) = T*/
        /*T(block_sigmask) = T*/
        /*T(delaying) = T*/
        /*T(init_done) = T*/
        
        /*sid:254*/
        {/*sid:255*/
         tmp_23 = __errno_location();
         /*sid:255*/
         /*T(tmp_23) = T*/
         
         /*sid:256*/
         }
        /*sid:257*/
        if (13 == *tmp_23) {/*sid:258*/
          userid_3 = geteuid();
          /*sid:258*/
          /*T(userid_3) = T*/
          
          /*sid:259*/
          delay_signaling();
          /*sid:260*/
          seteuid(0U);
          /*sid:261*/
          {/*sid:262*/
           tmp_22 = __errno_location();
           /*sid:262*/
           /*T(tmp_22) = T*/
           
           /*sid:263*/
           *tmp_22 = 0;}
          /*sid:264*/
          resultcode = chdir((char const   *)p);
          /*sid:265*/
          seteuid(userid_3);
          /*sid:266*/
          enable_signaling();}
        
        /*sid:269*/
        if (resultcode < 0) {/*sid:270*/
          goto err1;}
        
        /*sid:269*/
        /*T(userid_3) = T*/
        /*T(tmp_22) = T*/
        
        /*sid:272*/
        p = (char *)"";}
      }
    }
  
  /*sid:276*/
  strcpy((char *)(wbuf), (char const   *)p);
  /*sid:276*/
  /*T(saved_sigmask) = T*/
  /*T(block_sigmask) = T*/
  /*T(delaying) = T*/
  /*T(init_done) = T*/
  /*T(wbuf) = T*/
  /*T(tmp_20) = T*/
  /*T(userid_3) = T*/
  /*T(tmp_22) = T*/
  /*T(tmp_23) = T*/
  
  /*sid:277*/
  printf((char const   *)"wbuf now contains %s\n", wbuf);
  /*sid:278*/
  {/*sid:279*/
   tmp_24 = __errno_location();
   /*sid:279*/
   /*T(tmp_24) = T*/
   
   /*sid:280*/
   *tmp_24 = 0;}
  /*sid:281*/
  tmp_26 = getcwd(resolved, 46U);
  /*sid:281*/
  /*T(tmp_26) = T*/
  
  /*sid:282*/
  if (tmp_26 == (void *)0) {/*sid:283*/
  resultcode = 0;}
  else {/*sid:284*/
  resultcode = 1;}
  
  /*sid:285*/
  printf((char const   *)"getcwd: resultcode = %d\n", resultcode);
  /*sid:286*/
  {/*sid:287*/
   tmp_31 = __errno_location();
   /*sid:287*/
   /*T(tmp_31) = T*/
   
   /*sid:288*/
   }
  /*sid:289*/
  if (13 == *tmp_31) {/*sid:290*/
    userid_4 = geteuid();
    /*sid:290*/
    /*T(userid_4) = T*/
    
    /*sid:291*/
    delay_signaling();
    /*sid:292*/
    seteuid(0U);
    /*sid:293*/
    {/*sid:294*/
     tmp_28 = __errno_location();
     /*sid:294*/
     /*T(tmp_28) = T*/
     
     /*sid:295*/
     *tmp_28 = 0;}
    /*sid:296*/
    tmp_30 = getcwd(resolved, 46U);
    /*sid:296*/
    /*T(tmp_30) = T*/
    
    /*sid:297*/
    if (tmp_30 == (void *)0) {/*sid:298*/
    resultcode = 0;}
    else {/*sid:299*/
    resultcode = 1;}
    
    /*sid:300*/
    seteuid(userid_4);
    /*sid:301*/
    enable_signaling();}
  
  /*sid:304*/
  if (resultcode == 0) {/*sid:305*/
    printf((char const   *)"going to err1.. resultcode = %d\n", resultcode);
    /*sid:306*/
    goto err1;}
  
  /*sid:304*/
  /*T(userid_4) = T*/
  /*T(tmp_28) = T*/
  /*T(tmp_30) = T*/
  
  /*sid:309*/
  if ((int )*(resolved + 0) == '/')
  {/*sid:311*/
  if ((int )*(resolved + 1) == '\000')
  {/*sid:312*/
  rootd = 1;
  /*sid:312*/
  /*T(rootd) = T*/
  }
  else {/*sid:313*/
  rootd = 0;
  /*sid:313*/
  /*T(rootd) = T*/
  }
  }
  else {/*sid:314*/
  rootd = 0;
  /*sid:314*/
  /*T(rootd) = T*/
  }
  
  /*sid:315*/
  tmp_32 = strlen((char const   *)resolved);
  /*sid:315*/
  /*T(tmp_32) = T*/
  
  /*sid:316*/
  printf((char const   *)"resolved(%d) = %s\n", tmp_32, resolved);
  /*sid:317*/
  tmp_33 = strlen((char const   *)(wbuf));
  /*sid:317*/
  /*T(tmp_33) = T*/
  
  /*sid:318*/
  printf((char const   *)"wbuf(%d) = %s \n", tmp_33, wbuf);
  /*sid:319*/
  printf((char const   *)"rootd=%d\n", rootd);
  /*sid:320*/
  {/*sid:321*/
   tmp_34 = strlen((char const   *)resolved);
   /*sid:321*/
   /*T(tmp_34) = T*/
   
   /*sid:322*/
   tmp_35 = strlen((char const   *)(wbuf));
   /*sid:322*/
   /*T(tmp_35) = T*/
   }
  /*sid:323*/
  printf((char const   *)"strlen(resolved) + strlen(wbuf) + rootd + 1 = %d\n",
         ((tmp_34 + tmp_35) + (size_t )rootd) + (size_t )1);
  /*sid:325*/
  if (wbuf[0]) {/*sid:326*/
    {/*sid:327*/
     tmp_37 = strlen((char const   *)resolved);
     /*sid:327*/
     /*T(tmp_37) = T*/
     
     /*sid:328*/
     tmp_38 = strlen((char const   *)(wbuf));
     /*sid:328*/
     /*T(tmp_38) = T*/
     
     /*sid:329*/
     }
    /*sid:330*/
    if (((tmp_37 + tmp_38) + (size_t )rootd) + (size_t )1 > (size_t )46) {/*sid:331*/
      {/*sid:332*/
       tmp_36 = __errno_location();
       /*sid:332*/
       /*T(tmp_36) = T*/
       
       /*sid:333*/
       *tmp_36 = 36;}
      /*sid:334*/
      printf((char const   *)"resolved path too long!\n");
      /*sid:335*/
      goto err1;
      /*sid:335*/
      /*T(serrno) = T*/
      /*T(tmp_11) = T*/
      /*T(tmp_16) = T*/
      }
    
    /*sid:338*/
    if (rootd == 0) {/*sid:339*/
      strcat((char *)resolved, (char const   *)"/");}
    
    /*sid:341*/
    tmp_39 = strlen((char const   *)resolved);
    /*sid:341*/
    /*T(tmp_39) = T*/
    
    /*sid:342*/
    printf((char const   *)"resolved=%s  len=%d \n", resolved, tmp_39);
    /*sid:343*/
    tmp_40 = strlen((char const   *)(wbuf));
    /*sid:343*/
    /*T(tmp_40) = T*/
    
    /*sid:344*/
    printf((char const   *)"wbuf=%s  len=%d \n", wbuf, tmp_40);
    /*sid:345*/
    strcat((char *)resolved, (char const   *)(wbuf));
    /*sid:346*/
    tmp_41 = strlen((char const   *)resolved);
    /*sid:346*/
    /*T(tmp_41) = T*/
    
    /*sid:347*/
    printf((char const   *)"after strcat, resolved = %s, strlen(resolved) = %d\n",
           resolved, tmp_41);
    /*sid:348*/
    tmp_42 = strlen((char const   *)resolved);
    /*sid:348*/
    /*T(tmp_42) = T*/
    
    /*sid:349*/
    if (tmp_42 + (size_t )1 > (size_t )46) {/*sid:350*/
      printf((char const   *)"strlen(resolve) > MAXPATHLEN -- buffer overflow\n");}
    }
  
  /*sid:353*/
  {/*sid:354*/
   tmp_43 = __errno_location();
   /*sid:354*/
   /*T(tmp_43) = T*/
   
   /*sid:355*/
   *tmp_43 = 0;}
  /*sid:353*/
  /*T(tmp_37) = T*/
  /*T(tmp_38) = T*/
  /*T(tmp_39) = T*/
  /*T(tmp_40) = T*/
  /*T(tmp_41) = T*/
  /*T(tmp_42) = T*/
  
  /*sid:356*/
  resultcode = fchdir(fd);
  /*sid:357*/
  {/*sid:358*/
   tmp_46 = __errno_location();
   /*sid:358*/
   /*T(tmp_46) = T*/
   
   /*sid:359*/
   }
  /*sid:360*/
  if (13 == *tmp_46) {/*sid:361*/
    userid_5 = geteuid();
    /*sid:361*/
    /*T(userid_5) = T*/
    
    /*sid:362*/
    delay_signaling();
    /*sid:363*/
    seteuid(0U);
    /*sid:364*/
    {/*sid:365*/
     tmp_45 = __errno_location();
     /*sid:365*/
     /*T(tmp_45) = T*/
     
     /*sid:366*/
     *tmp_45 = 0;}
    /*sid:367*/
    resultcode = fchdir(fd);
    /*sid:368*/
    seteuid(userid_5);
    /*sid:369*/
    enable_signaling();}
  
  /*sid:372*/
  if (resultcode < 0) {/*sid:373*/
    tmp_47 = __errno_location();
    /*sid:373*/
    /*T(tmp_47) = T*/
    
    /*sid:374*/
    serrno = *tmp_47;
    /*sid:374*/
    /*T(serrno) = T*/
    
    /*sid:375*/
    goto err2;}
  
  /*sid:372*/
  /*T(userid_5) = T*/
  /*T(tmp_45) = T*/
  
  /*sid:377*/
  close(fd);
  /*sid:378*/
  __retres = resolved;
  /*sid:378*/
  /*T(__retres) = T*/
  
  /*sid:409*/
  goto return_label;
  /*sid:379*/
  err1: 
  tmp_48 = __errno_location();
  /*sid:379*/
  /*T(tmp_26) = T*/
  /*T(userid_4) = T*/
  /*T(tmp_28) = T*/
  /*T(tmp_30) = T*/
  /*T(tmp_31) = T*/
  /*T(tmp_32) = T*/
  /*T(tmp_33) = T*/
  /*T(tmp_34) = T*/
  /*T(tmp_35) = T*/
  /*T(tmp_36) = T*/
  /*T(tmp_37) = T*/
  /*T(tmp_38) = T*/
  /*T(tmp_48) = T*/
  /*T(saved_sigmask) = T*/
  /*T(block_sigmask) = T*/
  /*T(delaying) = T*/
  /*T(init_done) = T*/
  /*T(rootd) = T*/
  /*T(serrno) = T*/
  /*T(wbuf) = T*/
  /*T(tmp_11) = T*/
  /*T(tmp_16) = T*/
  /*T(tmp_20) = T*/
  /*T(userid_3) = T*/
  /*T(tmp_22) = T*/
  /*T(tmp_23) = T*/
  /*T(tmp_24) = T*/
  
  /*sid:380*/
  serrno = *tmp_48;
  /*sid:381*/
  fchdir(fd);
  /*sid:382*/
  {/*sid:383*/
   tmp_50 = __errno_location();
   /*sid:383*/
   /*T(tmp_50) = T*/
   
   /*sid:384*/
   }
  /*sid:385*/
  if (13 == *tmp_50) {/*sid:386*/
    userid_6 = geteuid();
    /*sid:386*/
    /*T(userid_6) = T*/
    
    /*sid:387*/
    delay_signaling();
    /*sid:388*/
    seteuid(0U);
    /*sid:389*/
    fchdir(fd);
    /*sid:390*/
    seteuid(userid_6);
    /*sid:391*/
    enable_signaling();
    /*sid:391*/
    /*T(tmp_39) = T*/
    /*T(tmp_40) = T*/
    /*T(tmp_41) = T*/
    /*T(tmp_42) = T*/
    /*T(tmp_43) = T*/
    /*T(userid_5) = T*/
    /*T(tmp_45) = T*/
    /*T(tmp_46) = T*/
    /*T(tmp_47) = T*/
    }
  
  /*sid:393*/
  err2: ;
  /*sid:393*/
  /*T(tmp_36) = T*/
  /*T(tmp_39) = T*/
  /*T(tmp_40) = T*/
  /*T(tmp_41) = T*/
  /*T(tmp_42) = T*/
  /*T(tmp_43) = T*/
  /*T(userid_5) = T*/
  /*T(tmp_45) = T*/
  /*T(tmp_46) = T*/
  /*T(tmp_47) = T*/
  /*T(tmp_48) = T*/
  /*T(userid_6) = T*/
  /*T(tmp_50) = T*/
  /*T(tmp_11) = T*/
  /*T(tmp_16) = T*/
  
  /*sid:394*/
  close(fd);
  /*sid:395*/
  {/*sid:396*/
   tmp_51 = __errno_location();
   /*sid:396*/
   /*T(tmp_51) = T*/
   
   /*sid:397*/
   *tmp_51 = serrno;}
  /*sid:398*/
  __retres = (char *)((void *)0);
  /*sid:398*/
  /*T(__retres) = T*/
  
  /*sid:410*/
  return_label: /* CIL Label */ 
  return (__retres);
  /*sid:410*/
  /*T(tmp_26) = T*/
  /*T(userid_4) = T*/
  /*T(tmp_28) = T*/
  /*T(tmp_30) = T*/
  /*T(tmp_31) = T*/
  /*T(tmp_32) = T*/
  /*T(tmp_33) = T*/
  /*T(tmp_34) = T*/
  /*T(tmp_35) = T*/
  /*T(tmp_36) = T*/
  /*T(tmp_37) = T*/
  /*T(tmp_38) = T*/
  /*T(tmp_39) = T*/
  /*T(tmp_40) = T*/
  /*T(tmp_41) = T*/
  /*T(tmp_42) = T*/
  /*T(tmp_43) = T*/
  /*T(userid_5) = T*/
  /*T(tmp_45) = T*/
  /*T(tmp_46) = T*/
  /*T(tmp_47) = T*/
  /*T(tmp_48) = T*/
  /*T(userid_6) = T*/
  /*T(tmp_50) = T*/
  /*T(tmp_51) = T*/
  /*T(saved_sigmask) = T*/
  /*T(block_sigmask) = T*/
  /*T(delaying) = T*/
  /*T(init_done) = T*/
  /*T(__retres) = T*/
  /*T(fb_realpath) = T*/
  /*T(resolved) = T*/
  /*T(rootd) = T*/
  /*T(serrno) = T*/
  /*T(p) = T*/
  /*T(q) = T*/
  /*T(wbuf) = T*/
  /*T(resultcode) = T*/
  /*T(tmp_2) = T*/
  /*T(userid_0) = T*/
  /*T(tmp_4) = T*/
  /*T(tmp_5) = T*/
  /*T(tmp_6) = T*/
  /*T(tmp_7) = T*/
  /*T(userid_1) = T*/
  /*T(tmp_9) = T*/
  /*T(tmp_10) = T*/
  /*T(symlinks) = T*/
  /*T(n) = T*/
  /*T(tmp_11) = T*/
  /*T(tmp_12) = T*/
  /*T(len) = T*/
  /*T(tmp_14) = T*/
  /*T(tmp_16) = T*/
  /*T(userid_2) = T*/
  /*T(tmp_18) = T*/
  /*T(tmp_19) = T*/
  /*T(tmp_20) = T*/
  /*T(userid_3) = T*/
  /*T(tmp_22) = T*/
  /*T(tmp_23) = T*/
  /*T(tmp_24) = T*/
  }

}
